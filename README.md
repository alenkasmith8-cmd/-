# Банковское приложение

## Цель проекта
Этот проект предоставляет функции для маскирования номеров карт и банковских счетов. Функции позволяют скрыть определенные части номеров и защищают личные данные пользователей.

## Установка

Для установки необходимых зависимостей выполните следующие команды:

1. Установите Poetry (если он ещё не установлен).
2. Клонируйте репозиторий:
bash
   git clone https://github.com/alenkasmith8-cmd/-/pull/13

3. Перейдите в директорию проекта и выполните:
bash
   poetry install


## Использование

### Фильтрация по статусу

Функция `filter_by_state()` принимает список словарей и значение ключа `state`. Она возвращает новый список словарей.

**Пример использования:**
python
items = [
    {'id': 1, 'state': 'EXECUTED'},
    {'id': 2, 'state': 'CANCELED'}
]
filtered_items = filter_by_state(items, 'EXECUTED')
print(filtered_items)  # Output: [{'id': 1, 'state': 'EXECUTED'}]
```
```
### Сортировка по дате
Функция sort_by_date() принимает список словарей и параметр reverse, который задает порядок сортировки.

Пример использования:
python
items = [
    {'id': 1, 'date': '2023-01-01T12:00:00'},
    {'id': 2, 'date': '2022-12-31T12:00:00'}
]
sorted_items = sort_by_date(items)
print(sorted_items)  # Output: [{'id': 1, 'date': '2023-01-01T12:00:00'}, {'id': 2, 'date': '2022-12-31T12:00:00'}]

## Модуль Decorators
В этом модуле реализованы декораторы для логирования функций. Декораторы позволяют автоматически вести журнал вызовов функций, хранить входные параметры и результаты, а также обрабатывать исключения.

Использование декоратора @log()
Для применения декоратора логирования используйте его перед определением функции.

Пример использования:
```python
from decorators import log

@log()
def successful_function(x: int, y: int) -> int:
    return x + y
```

Логирование во время выполнения
Декоратор записывает информацию о вызовах функции, включая входные параметры, результат и любые возникающие ошибки. Логи могут сохраняться в файл или выводиться в консоль в зависимости от настройки.

Основные функции декоратора:

Функция log(filename: Optional[str] = None): Декоратор для логирования начала и конца выполнения функции. Принимает опциональный параметр filename для записи логов в файл.
Пример логирования:
python
@log("app.log")
def my_function(param):
    return param * 2

## Модуль masks:
Основные функции:
mask_card_number(card_number: str) -> str: Маскирует номер карты, заменяя все, кроме последних 4 цифр, на *.
Пример использования:
python
masked_number = mask_card_number("1234 5678 9012 3456")
print(masked_number)  # Output: "**** **** **** 3456"

mask_account_number(account_number: str) -> str: Маскирует номер банковского счета, оставляя видимой только часть конца.
Пример использования:
python
masked_account = mask_account_number("987654321012")
print(masked_account)  # Output: "*******012"

## Модуль Utils
Описание
Модуль utils содержит вспомогательные функции для обработки данных, включая функции маскирования номеров карт и банковских счетов.

Тестирование модуля Utils
Модуль test_utils содержит тесты для функций из модуля utils.

Запуск тестов
Для запуска тестов используйте команду:
bash
pytest tests/test_utils.py

Описание тестов
Тестирование функции mask_card_number(): Проверяет корректность маскирования номеров карт на разных сценариях.
Тестирование функции mask_account_number(): Проверяет корректность маскирования номеров банковских счетов.
Модуль External API
Описание
## Модуль external_api содержит функции для получения текущих курсов валют и конвертации сумм по заданным курсам.

Основные функции:
get_exchange_rate(currency: str) -> float: Получает текущий курс валют для указанной валюты.
Пример использования:
python
rate = get_exchange_rate("USD")
print(rate)  # Выводит текущий курс USD к рублю

convert_to_rub(transaction: Dict[str, Any]) -> float: Конвертирует сумму транзакции в рубли исходя из валюты.
Пример использования:
python
transaction = {"amount": 100, "currency": "USD"}
rub_amount = convert_to_rub(transaction)
print(rub_amount)  # Выводит сумму в рублях

Тестирование модуля External API
Модуль test_external_api содержит тесты для функций из модуля external_api.

Запуск тестов
Для запуска тестов используйте команду:
bash
pytest tests/test_external_api.py

Описание тестов
Тестирование функции get_exchange_rate(): Проверяет корректность получения курсов валют для различных валют.
Тестирование функции convert_to_rub(): Проверяет правильность конвертации сумм в рубли согласно текущему курсу.
Тестирование
Для тестирования проекта используются библиотеки pytest. В проекте написаны автоматизированные тесты, которые проверяют корректность работы всех функций, включая функции в модулях masks, widget, decorators, utils и external_api.

Запуск тестов
Убедитесь, что все зависимости установлены, выполнив:
bash
poetry install

Для запуска тестов используйте команду:
bash
pytest

По мере необходимости, вы можете запускать тесты для определенного файла, например:
bash
pytest tests/test_файл.py

Описание тестов
- Тестирование модуля masks: Проверяет функции маскирования на разные сценарии ввода, чтобы убедиться, что номера карт и счетов скрываются корректно.
- Тестирование модуля widget: Проверяет взаимодействие пользователя с интерфейсом, обеспечивая корректность обработки входных данных и отображения результатов.
- Тестирование функции filter_by_state(): Проверяет правильность фильтрации по статусу, включая случаи с отсутствующими результатами.
- Тестирование функции sort_by_date(): Проверяет правильность сортировки по дате, включая сортировку с одинаковыми датами и на пустом списке.
- Тестирование декоратора log(): Проверяет корректность записи логов и обработки ошибок.
- Тестирование модуля utils: Проверяет функции маскирования на различных входных данных.
- Тестирование модуля external_api: Проверяет корректность получения курсов валют и конвертации сумм с валюты в рубли.

## Модуль Generators
- Функции генераторов
filter_by_currency(transactions, currency_code): Генератор, который возвращает транзакции с заданной валютой.
Пример использования:
python
usd_transactions = filter_by_currency(transactions, "USD")
for transaction in usd_transactions:
    print(transaction)

transaction_descriptions(transactions): Генератор, который возвращает описание каждой транзакции.
Пример использования:
python
descriptions = transaction_descriptions(transactions)
for description in descriptions:
    print(description)

card_number_generator(start, end): Генератор, который выдает номера банковских карт в формате XXXX XXXX XXXX XXXX.
Пример использования:
python
for card_number in card_number_generator(1, 5):
    print(" ".join(card_number))

## Запуск тестов для генераторов
Чтобы запустить тесты для модуля генераторов, используйте команду:
bash
python -m unittest test_generators.py
```
```
 # Модуль для новых функций data_reader.

- Реализованы функция для считывания финансовых операций из CSV
 read_transactions_from_csv и функция для считывания финансовых операций из Excel read_transactions_from_excel. 
- функции для считывания финансовых операций из CSV и Excel принимают путь к файлу CSV и Excel в качестве аргумента. 
- Функция для считывания финансовых операций из CSV и Excel выдают список словарей с транзакциями. Все необходимые для
 работы библиотеки добавлены в зависимости проекта.
- Созданы тесты к новым функциональностям проекта, модуль test_transaction_cvs_xlsx.py. Тесты для функции считывания финансовых 
операций из CSV и Excel используют Mock и patch.
В модули внесены компоненты логирования. 
- Для реализации считывания финансовых операций из CSV- и XLSX-файлов скачаны файлы (transactions.csv) и 
(transactions_excel.xlsx). Данные файлы помещены в директорию data.

## Создан модуль main в папке src.
В ней создана функция load_transactions, которая принимает список словарей с данными о банковских операциях и строку 
поиска, а возвращает список словарей, у которых в описании есть данная строка. При реализации этой функции использована 
библиотека re. Данная функция обрабатывает файлы находящиеся в папке data с расширениями CSV XLSX и json -файлов. Список 
словарей с данными о банковских операциях и список категорий операций возвращается в словарь, в котором ключи — это 
названия категорий, а значения — это количество операций в каждой категории. Категории операций хранятся в поле description.

В модуле main реализована следующая логика проекта. Ожидаемое поведение программы:

Программа приветствует пользователя: Программа: Привет! Добро пожаловать в программу работы с банковскими транзакциями.
Выберите необходимый пункт меню: 1. Получить информацию о транзакциях из JSON-файла 2. Получить информацию о транзакциях
из CSV-файла 3. Получить информацию о транзакциях из XLSX-файла Пользователь: 1 Программа: Для обработки выбран JSON-файл.
Программа: Введите статус, по которому необходимо выполнить фильтрацию. Доступные для фильтровки статусы: EXECUTED, 
CANCELED, PENDING Пользователь: EXECUTED Программа:Операции отфильтрованы по статусу "EXECUTED" В случае, если 
пользователь ввел неверный статус, программа не должна падать в ошибку, а должна возвращать пользователя к вводу 
корректного статуса: Пользователь: test Программа: Статус операции "test" недоступен. Программа: Введите статус,
по которому необходимо выполнить фильтрацию. Доступные для фильтровки статусы: EXECUTED, CANCELED, PENDING После 
фильтрации программа выводит следующие вопросы для уточнения выборки операций, необходимых пользователю, и выводит
в консоль операции, соответствующие выборке пользователя: 
- Программа: Отсортировать операции по дате? Да/Нет
- Пользователь: да 
- Программа: Отсортировать по возрастанию или по убыванию? 
- Пользователь: по возрастанию/по убыванию 
- Программа: Выводить только рублевые транзакции? Да/Нет 
- Пользователь: да 
- Программа: Отфильтровать список транзакций по определенному слову в описании? Да/Нет 
- Пользователь: да/нет 
- Программа: Распечатываю итоговый список транзакций...

- Программа: Всего банковских операций в выборке: 4

08.12.2019 Открытие вклада Счет **4321 Сумма: 40542 руб.

12.11.2019 Перевод с карты на карту MasterCard 7771 27** **** 3727 -> Visa Platinum 1293 38** **** 9203 Сумма: 130 USD

18.07.2018 Перевод организации Visa Platinum 7492 65** **** 7202 -> Счет **0034 Сумма: 8390 руб.

03.06.2018 Перевод со счета на счет Счет **2935 -> Счет **4321 Сумма: 8200 EUR

Если выборка оказалась пустой, программа выводит сообщение: Программа: Не найдено ни одной транзакции, подходящей под ваши условия фильтрации

Создан модуль config для хранения конфигурационных параметров, настроек и глобальных переменных, которые использованы в других частях приложения. Это позволяет централизовать управление настройками и упрощает изменение конфигурации без необходимости вносить изменения в код. Это сделано для централизованного управления, упрощение кода, для легкости в тестировании и разделение логики и конфигурации.

Для тестирования в tests создан модуль *test_main. В нем реализованы 29 функций для тестирования модуля main.